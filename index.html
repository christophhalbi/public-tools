<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Stromverbrauch Tracker</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState } = React;
        
        // Lucide React icons as simple components
        const Download = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                <polyline points="7,10 12,15 17,10"/>
                <line x1="12" y1="15" x2="12" y2="3"/>
            </svg>
        );

        const Plus = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <line x1="12" y1="5" x2="12" y2="19"/>
                <line x1="5" y1="12" x2="19" y2="12"/>
            </svg>
        );

        const Trash2 = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <polyline points="3,6 5,6 21,6"/>
                <path d="m19,6v14a2,2 0 0,1 -2,2H7a2,2 0 0,1 -2,-2V6m3,0V4a2,2 0 0,1 2,-2h4a2,2 0 0,1 2,2v2"/>
                <line x1="10" y1="11" x2="10" y2="17"/>
                <line x1="14" y1="11" x2="14" y2="17"/>
            </svg>
        );

        const Calculator = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <rect x="4" y="2" width="16" height="20" rx="2"/>
                <line x1="8" y1="6" x2="16" y2="6"/>
                <line x1="16" y1="14" x2="16" y2="18"/>
                <path d="m16,10l4,4"/>
                <path d="m12,10l4,4"/>
            </svg>
        );

        const StromverbrauchTracker = () => {
            const [devices, setDevices] = useState([
                { id: 1, name: 'Kühlschrank 1', power: 150, operatingHours: 24 },
                { id: 2, name: 'Kühlschrank 2', power: 140, operatingHours: 24 },
                { id: 3, name: 'Tiefkühler', power: 200, operatingHours: 24 },
                { id: 8, name: 'WLAN-Router', power: 12, operatingHours: 24 },
                { id: 4, name: 'Fernseher 1', power: 120, operatingHours: 6 },
                { id: 5, name: 'Fernseher 2', power: 80, operatingHours: 4 },
                { id: 6, name: 'Wäschetrockner', power: 2500, operatingHours: 2 },
                { id: 7, name: 'Waschmaschine', power: 2000, operatingHours: 1.5 },
                { id: 10, name: 'Herd und Ofen', power: 3000, operatingHours: 1.5 },
                { id: 9, name: 'Geschirrspüler', power: 1800, operatingHours: 1 }
            ]);

            const [newDevice, setNewDevice] = useState({
                name: '',
                power: '',
                operatingHours: ''
            });

            const addDevice = () => {
                if (newDevice.name && newDevice.power && newDevice.operatingHours) {
                    setDevices([...devices, {
                        id: Math.max(...devices.map(d => d.id)) + 1,
                        name: newDevice.name,
                        power: parseFloat(newDevice.power),
                        operatingHours: parseFloat(newDevice.operatingHours)
                    }]);
                    setNewDevice({ name: '', power: '', operatingHours: '' });
                }
            };

            const removeDevice = (id) => {
                setDevices(devices.filter(d => d.id !== id));
            };

            const updateDevice = (id, field, value) => {
                setDevices(devices.map(d => 
                    d.id === id ? { ...d, [field]: field === 'name' ? value : parseFloat(value) || 0 } : d
                ));
            };

            const calculateConsumption = (power, hours) => {
                return (power * hours / 1000).toFixed(2); // kWh per day
            };

            const totalConsumption = devices.reduce((sum, d) => sum + (d.power * d.operatingHours / 1000), 0);

            const exportToExcel = () => {
                const data = devices.map(device => ({
                    'Gerät': device.name,
                    'Leistung (Watt)': device.power,
                    'Betriebsstunden/Tag': device.operatingHours,
                    'Verbrauch (kWh/Tag)': calculateConsumption(device.power, device.operatingHours),
                    'Verbrauch (kWh/Monat)': (calculateConsumption(device.power, device.operatingHours) * 30).toFixed(2),
                    'Verbrauch (kWh/Jahr)': (calculateConsumption(device.power, device.operatingHours) * 365).toFixed(2)
                }));

                // Add summary
                data.push({});
                data.push({
                    'Gerät': 'GESAMT',
                    'Leistung (Watt)': devices.reduce((sum, d) => sum + d.power, 0),
                    'Betriebsstunden/Tag': '',
                    'Verbrauch (kWh/Tag)': totalConsumption.toFixed(2),
                    'Verbrauch (kWh/Monat)': (totalConsumption * 30).toFixed(2),
                    'Verbrauch (kWh/Jahr)': (totalConsumption * 365).toFixed(2)
                });

                const worksheet = XLSX.utils.json_to_sheet(data);
                const workbook = XLSX.utils.book_new();
                XLSX.utils.book_append_sheet(workbook, worksheet, 'Stromverbrauch');

                // Adjust column width
                worksheet['!cols'] = [
                    { width: 20 }, // Gerät
                    { width: 15 }, // Leistung
                    { width: 18 }, // Betriebsstunden
                    { width: 18 }, // Verbrauch/Tag
                    { width: 20 }, // Verbrauch/Monat
                    { width: 18 }  // Verbrauch/Jahr
                ];

                XLSX.writeFile(workbook, 'Stromverbrauch_Haushalt.xlsx');
            };

            return (
                <div className="min-h-screen py-8 px-4">
                    <div className="max-w-6xl mx-auto bg-white/95 backdrop-blur-sm rounded-2xl shadow-2xl p-8">
                        <div className="mb-8 text-center">
                            <h1 className="text-4xl font-bold text-gray-800 mb-3 flex items-center justify-center gap-3">
                                ⚡ Stromverbrauch Tracker
                            </h1>
                            <p className="text-gray-600 text-lg">Verwalte und tracke den Stromverbrauch deiner Haushaltsgeräte</p>
                        </div>

                        {/* Add new device */}
                        <div className="bg-gradient-to-r from-blue-50 to-indigo-100 p-6 rounded-xl mb-8 border border-blue-200">
                            <h2 className="text-xl font-semibold mb-4 flex items-center text-blue-800">
                                <Plus className="mr-3" size={24} />
                                Neues Gerät hinzufügen
                            </h2>
                            <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
                                <input
                                    type="text"
                                    placeholder="Gerätename"
                                    value={newDevice.name}
                                    onChange={(e) => setNewDevice({...newDevice, name: e.target.value})}
                                    className="p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"
                                />
                                <input
                                    type="number"
                                    placeholder="Leistung (Watt)"
                                    value={newDevice.power}
                                    onChange={(e) => setNewDevice({...newDevice, power: e.target.value})}
                                    className="p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"
                                />
                                <input
                                    type="number"
                                    step="0.1"
                                    placeholder="Betriebsstunden/Tag"
                                    value={newDevice.operatingHours}
                                    onChange={(e) => setNewDevice({...newDevice, operatingHours: e.target.value})}
                                    className="p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"
                                />
                            </div>
                            <button
                                onClick={addDevice}
                                className="mt-4 bg-gradient-to-r from-blue-600 to-blue-700 text-white px-6 py-3 rounded-lg hover:from-blue-700 hover:to-blue-800 transition-all transform hover:scale-105 flex items-center shadow-lg"
                            >
                                <Plus className="mr-2" size={18} />
                                Gerät hinzufügen
                            </button>
                        </div>

                        {/* Device table */}
                        <div className="bg-white border border-gray-200 rounded-xl overflow-hidden shadow-lg mb-8">
                            <div className="overflow-x-auto">
                                <table className="w-full">
                                    <thead className="bg-gradient-to-r from-gray-700 to-gray-800">
                                        <tr>
                                            <th className="p-4 text-left font-semibold text-white">Gerät</th>
                                            <th className="p-4 text-right font-semibold text-white">Leistung (W)</th>
                                            <th className="p-4 text-right font-semibold text-white">Std/Tag</th>
                                            <th className="p-4 text-right font-semibold text-white">kWh/Tag</th>
                                            <th className="p-4 text-right font-semibold text-white">kWh/Monat</th>
                                            <th className="p-4 text-right font-semibold text-white">kWh/Jahr</th>
                                            <th className="p-4 text-center font-semibold text-white">Aktionen</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        {devices.map(device => (
                                            <tr key={device.id} className="border-t hover:bg-blue-50 transition-colors">
                                                <td className="p-4">
                                                    <input
                                                        type="text"
                                                        value={device.name}
                                                        onChange={(e) => updateDevice(device.id, 'name', e.target.value)}
                                                        className="w-full p-2 border border-gray-300 rounded-md focus:ring-1 focus:ring-blue-500 focus:border-transparent"
                                                    />
                                                </td>
                                                <td className="p-4 text-right">
                                                    <input
                                                        type="number"
                                                        value={device.power}
                                                        onChange={(e) => updateDevice(device.id, 'power', e.target.value)}
                                                        className="w-20 p-2 border border-gray-300 rounded-md text-right focus:ring-1 focus:ring-blue-500 focus:border-transparent"
                                                    />
                                                </td>
                                                <td className="p-4 text-right">
                                                    <input
                                                        type="number"
                                                        step="0.1"
                                                        value={device.operatingHours}
                                                        onChange={(e) => updateDevice(device.id, 'operatingHours', e.target.value)}
                                                        className="w-20 p-2 border border-gray-300 rounded-md text-right focus:ring-1 focus:ring-blue-500 focus:border-transparent"
                                                    />
                                                </td>
                                                <td className="p-4 text-right font-mono text-blue-600 font-semibold">
                                                    {calculateConsumption(device.power, device.operatingHours)}
                                                </td>
                                                <td className="p-4 text-right font-mono text-green-600 font-semibold">
                                                    {(calculateConsumption(device.power, device.operatingHours) * 30).toFixed(2)}
                                                </td>
                                                <td className="p-4 text-right font-mono text-orange-600 font-semibold">
                                                    {(calculateConsumption(device.power, device.operatingHours) * 365).toFixed(2)}
                                                </td>
                                                <td className="p-4 text-center">
                                                    <button
                                                        onClick={() => removeDevice(device.id)}
                                                        className="text-red-600 hover:text-red-800 hover:bg-red-100 p-2 rounded-md transition-all"
                                                        title="Gerät löschen"
                                                    >
                                                        <Trash2 size={16} />
                                                    </button>
                                                </td>
                                            </tr>
                                        ))}
                                    </tbody>
                                    <tfoot className="bg-gradient-to-r from-gray-100 to-gray-200 font-bold">
                                        <tr>
                                            <td className="p-4 text-gray-800">GESAMT</td>
                                            <td className="p-4 text-right text-gray-800">{devices.reduce((sum, d) => sum + d.power, 0)} W</td>
                                            <td className="p-4"></td>
                                            <td className="p-4 text-right text-blue-700 font-bold">{totalConsumption.toFixed(2)} kWh</td>
                                            <td className="p-4 text-right text-green-700 font-bold">{(totalConsumption * 30).toFixed(2)} kWh</td>
                                            <td className="p-4 text-right text-orange-700 font-bold">{(totalConsumption * 365).toFixed(2)} kWh</td>
                                            <td className="p-4"></td>
                                        </tr>
                                    </tfoot>
                                </table>
                            </div>
                        </div>

                        {/* Summary */}
                        <div className="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                            <div className="bg-gradient-to-br from-blue-400 to-blue-600 p-6 rounded-xl text-white shadow-lg transform hover:scale-105 transition-all">
                                <h3 className="font-semibold text-blue-100 mb-2">Täglicher Verbrauch</h3>
                                <p className="text-3xl font-bold">{totalConsumption.toFixed(2)} kWh</p>
                            </div>
                            <div className="bg-gradient-to-br from-green-400 to-green-600 p-6 rounded-xl text-white shadow-lg transform hover:scale-105 transition-all">
                                <h3 className="font-semibold text-green-100 mb-2">Monatlicher Verbrauch</h3>
                                <p className="text-3xl font-bold">{(totalConsumption * 30).toFixed(2)} kWh</p>
                            </div>
                            <div className="bg-gradient-to-br from-orange-400 to-orange-600 p-6 rounded-xl text-white shadow-lg transform hover:scale-105 transition-all">
                                <h3 className="font-semibold text-orange-100 mb-2">Jährlicher Verbrauch</h3>
                                <p className="text-3xl font-bold">{(totalConsumption * 365).toFixed(2)} kWh</p>
                            </div>
                        </div>

                        {/* Export Button */}
                        <div className="flex justify-center mb-8">
                            <button
                                onClick={exportToExcel}
                                className="bg-gradient-to-r from-green-600 to-green-700 text-white px-10 py-4 rounded-xl hover:from-green-700 hover:to-green-800 flex items-center text-lg font-semibold shadow-xl transform hover:scale-105 transition-all"
                            >
                                <Download className="mr-3" size={24} />
                                📊 Excel-Datei herunterladen
                            </button>
                        </div>

                        <div className="bg-blue-50 border-l-4 border-blue-400 p-6 rounded-r-lg">
                            <h3 className="font-semibold mb-3 text-blue-800 flex items-center">
                                💡 Hinweise:
                            </h3>
                            <ul className="list-disc list-inside space-y-2 text-blue-700">
                                <li>Alle Berechnungen basieren auf den angegebenen Betriebsstunden pro Tag</li>
                                <li>Die Excel-Datei enthält alle Verbrauchsdaten ohne Preisangaben</li>
                                <li>Verbrauchswerte werden automatisch für Tag, Monat und Jahr berechnet</li>
                                <li>Klicken Sie auf die Gerätedaten, um sie direkt zu bearbeiten</li>
                            </ul>
                        </div>
                    </div>
                </div>
            );
        };

        // Render the app
        ReactDOM.render(<StromverbrauchTracker />, document.getElementById('root'));
    </script>
</body>
</html>
